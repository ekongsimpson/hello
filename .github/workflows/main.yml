
name: Multi-Cloud K8s Deployment

on:
  push:
    branches: [main]

jobs:
  deploy-aks:
    name: Deploy to AKS
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Azure Login
        uses: azure/login@v1
        with:
          creds: ${{ secrets.AZURE_CREDENTIALS }}

      - name: Get AKS Credentials
        run: |
          az aks get-credentials --name ${{ vars.AKS_CLUSTER_NAME }} \
                                 --resource-group ${{ vars.AKS_RESOURCE_GROUP }} \
                                 --overwrite-existing
      - name: Deploy to AKS
        run: kubectl apply -f ./k8s-multicloud/aks/aks.yaml
